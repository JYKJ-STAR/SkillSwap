{% extends "shared/base.html" %}
{% block title %}SkillSwap - Log Reflection{% endblock %}

{% block styles %}
<link href="{{ url_for('static', filename='css/youth/youth_log_reflection.css') }}" rel="stylesheet">
{% endblock %}

{% block content %}
<!-- Back Button -->
<a href="{{ url_for('schedule.schedule') }}" class="back-btn" style="text-decoration:none;">
    <i class="bi bi-arrow-left"></i> Back
</a>

<!-- ========================================
     MAIN CONTENT
     ======================================== -->
<main class="main-container">
    <!-- Sidebar -->
    <aside class="rewards-sidebar">
        <div class="profile-avatar">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                <circle cx="12" cy="7" r="4" />
            </svg>
        </div>
        <h2 class="profile-name">{{ user.name if user else 'User' }}</h2>
        <p class="profile-age">{{ user.age if user and user.age else '' }} Years Old</p>
        <p class="profile-points" id="user-points" data-points="{{ user.points if user else 0 }}">
            {{ user.points if user else 0 }} Points
        </p>

        <a href="{{ url_for('rewards.rewards') }}" class="claim-rewards-btn"
            style="text-decoration: none; display: flex; justify-content: center; align-items: center;">
            Claim Rewards
        </a>

        <h3 class="sidebar-section-title">Skills</h3>
        <div class="skill-tags">
            {% if user and user.skills %}
            {% for skill in user.skills %}
            <span class="skill-tag">{{ skill }}</span>
            {% endfor %}
            {% else %}
            <span class="skill-tag">No skills added</span>
            {% endif %}
        </div>

        <h3 class="sidebar-section-title">Interests</h3>
        <div class="skill-tags">
            {% if user and user.interests %}
            {% for interest in user.interests %}
            <span class="skill-tag">{{ interest }}</span>
            {% endfor %}
            {% else %}
            <span class="skill-tag">No interests added</span>
            {% endif %}
        </div>
    </aside>

    <!-- Content - Reflection Form -->
    <section class="content">
        <h1 class="page-title">Log Reflection</h1>
        <h2 class="event-title-display">{{ event_title }}</h2>

        <!-- Error Message Container -->
        <div id="error-message" class="error-message" style="display: none;"></div>

        <form class="reflection-form" action="{{ url_for('schedule.submit_reflection') }}" method="POST"
            enctype="multipart/form-data">
            <input type="hidden" name="event_id" value="{{ event_id }}">

            <!-- Feedback Section -->
            <div class="form-section">
                <h3 class="section-title">How was your Session?</h3>
                <p class="section-subtitle">Your feedback helps us improve</p>

                <!-- Star Rating -->
                <div class="star-rating">
                    <span class="star" data-rating="1"></span>
                    <span class="star" data-rating="2"></span>
                    <span class="star" data-rating="3"></span>
                    <span class="star" data-rating="4"></span>
                    <span class="star" data-rating="5"></span>
                </div>
                <input type="hidden" name="rating" id="rating_input">

                <!-- Feedback Textarea -->
                <textarea name="comment" class="feedback-textarea" placeholder="Share your thoughts"></textarea>
            </div>

            <!-- Upload Photo Section -->
            <div class="form-section">
                <h3 class="section-title">Upload Photo with Attendees</h3>
                <p class="section-subtitle">Help us verify that you were here!</p>

                <!-- Upload Area -->
                <div class="upload-area" id="uploadArea">
                    <div class="camera-icon">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <rect x="2" y="6" width="20" height="14" rx="2" ry="2" />
                            <circle cx="12" cy="13" r="4" />
                            <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
                        </svg>
                    </div>
                    <p class="upload-text">Click to upload photo</p>
                    <p class="upload-format">JPG or PNG</p>
                    <!-- File Input -->
                    <input type="file" name="photo" class="file-input" id="fileInput" accept=".jpg,.jpeg,.png">
                </div>

                <!-- Preview Container -->
                <div class="preview-container" id="previewContainer">
                    <img src="" alt="Preview" class="preview-image" id="previewImage">
                    <p class="preview-name" id="previewName"></p>
                </div>
            </div>

            <!-- Points Indicator -->
            <p class="points-indicator">+{{ points or 100 }} Points</p>

            <!-- Submit Button -->
            <button type="submit" class="submit-btn">Submit and Claim Points</button>
        </form>
    </section>
</main>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/youth/youth_log_reflection.js') }}"></script>
{% endblock %}